Bootstrap:library
From: centos:7

%environment

	#Setting up the hostname and port
	HOSTNAME=127.0.0.1
	PORT=27017
	export HOSTNAME PORT

%files
        mongod.conf /etc

%help

	blabla

%post
        yum -y update
        yum -y install wget vim
        cd /tmp
        wget -nc https://repo.mongodb.org/yum/redhat/7/mongodb-org/4.0/x86_64/RPMS/mongodb-org-server-4.0.8-1.el7.x86_64.rpm #-nc means don't overwrite.
        yum -y install ./mongodb-org-server-4.0.8-1.el7.x86_64.rpm

        rm -f /var/log/mongodb/mongod.log
        chmod -R 777 /var/log/mongodb

        wget -nc https://repo.mongodb.org/yum/redhat/7/mongodb-org/4.0/x86_64/RPMS/mongodb-org-shell-4.0.8-1.el7.x86_64.rpm
        yum -y install ./mongodb-org-shell-4.0.8-1.el7.x86_64.rpm

#        yum -y install ./mongodb-compass-community-1.17.0.x86_64.rpm

	#Setting up where data will reside
	#kdir -p /data/db
	#Give access to the folder
	#hmod -R 777 /data/db

	#Needed dependencies from GnuPG
	#apt-get update && apt-get install -y gnupg

	#Importing the public key
	#apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 9DA31620334BD75D9DCB49F368818C72E52529D4

	#Obtaining and installing MongoDB for Debian 9 (Stretch)
	#echo "deb http://repo.mongodb.org/apt/debian stretch/mongodb-org/4.0 main" | tee /etc/apt/sources.list.d/mongodb-org-4.0.list
	#apt-get -y update
	#apt-get install -y mongodb-org

	#Giving access to the mongodb user from the mongodb group user (these are the defaults from MongoDB)
	#chown -R mongodb:mongodb /data/db

%startscript

	#Stops the daemon if it is already running
	#mongod --repair
	#Starts the daemon
	#mongod
	#Starts the mongo shell in the hostname and port set from environment
	#mongo --host $HOSTNAME:$PORT

